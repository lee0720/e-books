---
html:
  embed_local_images: false
  embed_svg: true
  offline: false
  toc: true
print_background: false
export_on_save:
  html: true
  puppeteer: true
---
### 项目目录组织（namespace）

大多数人对于工作空间的概念依赖某些框架、某些工具定义好的生成规则，这种规则最早来源 IDE 时代。比如我们用 VS 创建一个项目 VS
创建对应的工作空间，创建各种各样的目录，很多时候只是往命名空间里添加文件，很少真正意义上的组织工作空间目录。很多操作系统源码对工具的依赖很低，它的目录组织都是基于人工的。

对于项目管理需要摆脱工具或者框架的规则，换一种方式去管理。

  * 应用程序框架，把逻辑代码填充到对应的框架中，由框架启动调用资源实现定制化。
  * 包或者库框架，提供功能性的服务。直接把它放到框架里使用。

应用程序框架是相对完整的应用程序，框架本身可以运行，我们管这种框架叫做 App
框架。我们只需要把逻辑放到指定的目录或者配置文件中，然后由这个框架在运行期载入自定义资源实现定制化，在框架开发定制服务和插件。

### Go 语言工作空间

工作空间（workspace）由 src、pkg、bin 三个固定目录构成。

    
    
    <workspace>/
     |
     +--- bin/ ;可执行文件安装目录
     |
     +--- pkg/ ;包(.a)安装目录
     |
     +--- src/ ;源码目录
                |
             +--- test
             |
             +--- mypkg
    

  * 工作空间使用特定目录结构，支持多个
  * 须添加到 GOPATH 环境变量
  * 某些时候 GOPATH 不是必须的
  * 当前正在移除 GOPATH 方案（modules）

Go 语言项目的工作空间有三个目录。以某个项目来说，平级构建目录没有根目录，这样从顶层的依赖而改为平级依赖。

#### **导入包**

使用其他包、标准库、第三方库前，须先导入（import）。

  * 关键字 import 引入目标包相对路径（非包名）。
  * 支持以别名解决命名冲突。
  * 以初始化方式引入包，用于执行。
  * 以简便方式简化测试代码。

导入包提供一个相对路径，编译器从 PATH 路径开始查找，把相对路径补全。编译器找到包进行编译，链接器把它们合并，最终和代码链接在一起。

#### **包导入模式**

    
    
    import "github.com/name/test" //默认方式：test.A
    import X "github.com/name/test"//别名方式: X.A
    import . "github.com/name/test"//简便方式: A
    import _ "github.com/name/test" //始化方式：无法引用，仅用来初始化目标包
    

常见使用的包会名字重名需要使用别名方式。

简短的方式相当于对方的名字空间引入到本地名字空间，建议不要使用。

### 组织结构

包（package）由同一目录下（不包含子目录），一到多个源码文件构成。

  * 包实现名字空间作用域和权限隔离。
  * 包名可与目录名不同。
  * 包名建议使用单数形式。
  * 源文件使用 UTF-8 编码。
  * 同一目录下（不包含子目录）只能有一个包。

组织结构就是项目源码的组织结构。全局变量必须通过包引用。

名字空间和语言有关系，不同的语言也有不同的做法。比如 Java、C# 用命名空间隔离，二进制包可以包含多个命名空间，而且有不同的深度。

### 多项目源码管理（project）

现代有两类项目框架，第一类是应用程序框架，整个生存环境都依赖框架定义的功能，只需要按照它的规则来定制。第二类是包或者库框架，我们怎么创建类似的规则？怎么管理我们的代码？

第一不要使用配置文件，最好的方式使用命令行参数，这样易于集成到自动化工具中。

第二建议把程序需要的环境构建成相对独立的环境，比如 Docker 的沙箱环境、Python
的虚拟空间目录环境。由于依赖第三方环境导致版本依赖，所以依赖第三方包建议用独立目录管理。

有些第三方工具，比如代码检查器、自动化工具，这些工具用来辅助完成项目开发。从开发者的角度来说，这些工具属于项目开发的一部分。从编译器的角度来说，这些工具和项目无关。通常做法是使用全局依赖目录，并把这个目录添加到搜索路径方便直接执行命令，也方便把工具升级到最新版本以保持最主流的开发规范。

#### **保留包名**

系统保留用于特殊目的包名。

  * main：用户可执行代码入口（main.main）。
  * std：标准库。
  * cmd：工具链。
  * all：标准库及 GOPATH 中所能找到的包。
  * documentation：存储文档信息，无法导入（与目录名无关）。

    
    
    package main
    
    import "test/documentation"
    
    func main() {
        documentation.A()
    }
    

编译器会排除 documentation 包下面的所有文件，这个目录用来保存帮助文件的。

### 约定大于配置

Linux 特点是约定大于配置，对于目录组织都预先设定好规则。Windows 用配置文件指定引用的包目录，Linux
遵循规则避免配置。比如共享库放在同一个目录，有的建立软链接指向私有的目录。Mac 用 brew 工具安装第三方库，所有的文件约定安装到 Celler
目录，opt 目录都会建立软链接。Linux 使用的管道命令利用组合完成工作也是一种约定。

> **感谢各位的光临哟！！**
> **获取更多资源:掘金小册,gitchat专栏,极客时间等资源；**
> **请到闲鱼店：583128058yanghon**
> **啊呜呜~~~**